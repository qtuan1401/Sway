PORTSMOUTH, N. H.  —   Donald J. Trump is locked in an explosive feud with Republicans in Washington and has already faced humiliating defections within his own party that have destabilized his campaign on the national level. But closer to the ground, he has also risked alienating an even more pivotal constituency in the swing states that will decide the presidential election: military communities dismayed by his crude and at times offensive comments about the armed services. Starting last week when he clashed with Khizr and Ghazala Khan, the parents of a Muslim captain in the Army who was killed in Iraq, Mr. Trump has reignited a set of controversies surrounding his approach to the military. He has drawn fresh attention to his derisive comments about Senator John McCain’s capture in Vietnam, as well as to his own avoidance of military service during the same war. He attacked Gen. John R. Allen, a retired Marine who endorsed Hillary Clinton, as a “failed general” over the weekend, and he joked at a campaign event on Tuesday about receiving a Purple Heart, the military decoration for soldiers wounded in combat. These missteps threaten Mr. Trump in the heart of the electoral map. In several important states, his most realistic path to victory hinges on areas with close ties to the military, including northern Florida, coastal Virginia and New Hampshire, and a cluster of towns near military bases in North Carolina, Colorado and Arizona. In Portsmouth, a seaside town close to a major naval installation, several military voters expressed acute doubts about Mr. Trump. Roger Palmer, an Army veteran, said Mr. Trump’s treatment of the Khans and of Mr. McCain had been unpresidential. Mr. Palmer, 56, a   conservative who wore a baseball hat with the Revolutionary War slogan “Join or Die,” said he did not plan to vote for Mr. Trump or Mrs. Clinton in the general election. “He’s basically a loose cannon,” Mr. Palmer said of Mr. Trump, adding that he voted for Senator Ted Cruz of Texas in the New Hampshire primary. “I don’t really want the mainstream establishment, but I do believe you should look presidential  —   like a leader. ” Should even a segment of   military voters recoil from Mr. Trump, it could badly undermine him in states where he is already struggling because of his deep unpopularity with women and racial minorities. Interviews this week with more than 50 voters linked to the military in five contested states found that Mr. Trump may not have driven away many people who were steadfastly supporting his campaign. And a number of veterans who expressed distaste for Mr. Trump said they would vote for him anyway, as an alternative to Mrs. Clinton. But Mr. Trump’s grating comments about the armed services have plainly become an obstacle to courting voters he must convert if he is to overtake Mrs. Clinton in the polls. For some Republicans and independent voters intrigued by Mr. Trump, his conduct around the military remains a sticking point. In Colorado Springs, near the Air Force Academy and the headquarters of the United States Northern Command, Marianne Quast, the mother of an Air Force veteran, said she had been drawn to Mr. Trump’s bluntness earlier in the campaign. Now, Ms. Quast said, she resents Mr. Trump’s disrespectful language about the military, including his response to the Khans and his joke about the Purple Heart. She said she trembled at the thought of her son serving under such a volatile president. “I’d honestly worry about a third world war. All those poor kids still serving. God forbid we elect Trump,” Ms. Quast said. She added, “Clearly Trump has no respect for veterans, no matter what he says. ” George Farnan, 79, a retired Navy captain in Jacksonville Beach, Fla. said he was inclined to support Mr. Trump over Mrs. Clinton, but called it a difficult choice. Mr. Trump’s disparagement of a Gold Star family had not helped, he said. “He should have kept his mouth shut, and the Democratic Party should not have stood Mr. Khan up and let him do that,” Mr. Farnan said. Of Mr. Trump’s reaction, Mr. Farnan said: “I’d have much more appreciated it if he just said, ‘We’re thankful for your son’s service. We’re thankful for you as parents for raising him and bringing him to our country, and that’s wonderful. ’” Mr. Trump took steps Wednesday to shield himself from the escalating criticism and stress his support for the military. At a campaign event in Daytona Beach, Fla. he was introduced by Michael Flynn, a retired Army lieutenant general advising his campaign. And before a rally in Jacksonville, Mr. Trump met with Gold Star families and later said they were “incredible folks. ” But Mr. Trump has continued to face reproach from prominent veterans in elected office this week. Mr. McCain released a searing statement on Monday invoking his own family’s long history of military service to denounce Mr. Trump’s comments about the Khans. On Wednesday, Representative Adam Kinzinger, Republican of Illinois and a veteran of the wars in Iraq and Afghanistan, said he could not vote for Mr. Trump. Advocates for veterans have spoken out against Mr. Trump. The Veterans of Foreign Wars called his comments about the Khans inexcusable. Steven SanPedro, the head of the V. F. W. in Maine, where Mr. Trump was campaigning on Thursday, said his members had been upset that Mr. Trump responded so personally to the Khans’ critical comments. “Bottom line, it’s about the fact that Mr. Trump attacked a Gold Star mother because of comments that the father made on behalf of the family,” said Mr. SanPedro, a veteran of both Iraq wars. “It would have been different if he attacked the comments, but he attacked the person. ” It is difficult to gauge exactly where the race stands among voters with ties to the military. Mr. Trump appears to have a faithful following among veterans and their families he has described himself as a champion of veterans and vowed to clean house at the Department of Veterans Affairs. A Gallup tracking poll in July, before the most recent uproar involving Mr. Trump, found that veterans were evenly split in their assessment of him. About half viewed him positively and half in unfavorable terms. Mrs. Clinton fared far worse: Only 27 percent of veterans had a favorable impression of her, according to the poll. Neil Newhouse, a Republican pollster who advised Mitt Romney in 2012, said he expected military voters to play an influential role in 2016 because national security issues are at the center of the race. The Romney campaign, he said, found in its polling that about one in eight registered voters had served in the military. “Because voters are increasingly factoring into their decisions which candidate they believe can better handle these security issues, the vet community’s voice carries significant weight,” Mr. Newhouse said. Whatever backlash he has faced so far, Mr. Trump can count on the continued backing of a formidable bloc of military voters in the swing states. Some Trump supporters with military ties were fiercely defensive of him. Richard Smith, 67, a Vietnam veteran from Tucson, said he believed the Khans were “radical Muslims and they should be kicked out of the country. ” And a number of people interviewed said they were concerned about Mr. Trump’s recent behavior, but would support him anyway. “He’s a jerk, but I’m voting for him because he’s the lesser of two evils,” said James Bell, 73, a Vietnam veteran in Jacksonville Beach. “Trump screwed up making those remarks about a Gold Star family. Period. That’s just what it is. ” At a rally in Tucson on Tuesday for Mr. Trump’s running mate, Gov. Mike Pence of Indiana, Keith Pritchard, 57, said that Mr. Trump had been mistreated in his standoff with the Khan family, and he blamed the Clinton campaign for stoking the controversy. “It’s unfortunate what happened to that Khan boy, but it’s just terrible what’s being done to Trump,” said Mr. Pritchard, who spent 30 years in the Air Force. Clifton Evans, 44, who owns a Virginia Beach tattoo parlor and whose family has served in the military, said he would vote for Mr. Trump despite concerns about his tone. “I think he does need to dial down his rhetoric and the way he speaks about some individuals,” Mr. Evans said, “because it doesn’t make him look that presidential. ” In some pockets of the extended military community, Mr. Trump has become a source of disagreement among friends. In Portsmouth, Bill Pierson, a V. F. W. and American Legion volunteer, said he believed strongly in Mr. Trump and would give him the benefit of the doubt on a handful of   remarks. But Phil Young, a   veteran of the Army and the Marines, walking alongside Mr. Pierson, was uneasier about the Republican nominee, sharing reservations that underscore the roadblocks confronting Mr. Trump. Mr. Young, 61, said he was a registered Republican but was still undecided about his vote. “The Purple Heart thing didn’t endear him with me, and also what he said about John McCain being a P. O. W. ,” Mr. Young said. He added, “I find what he says about the military interesting, considering that he never served. ”