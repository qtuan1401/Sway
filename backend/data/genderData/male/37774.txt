Washington (CNN) Robert Gates criticized both Hillary Clinton and Donald Trump on their preparedness to handle US foreign policy    but the former defense secretary reserved his harshest language for the Republican nominee, who he said is ”beyond repair.” ”When it comes to credibility problems, though, Donald Trump is in a league of his own,” Gates, a Republican who led the Defense Department under Presidents George W. Bush and Barack Obama, wrote in a Wall Street Journal   Friday, adding that electing Trump is ”too great a risk for America.” ”The world we confront is too perilous and too complex to have as president a man who believes he, and he alone, has all the answers and has no need to listen to anyone,” Gates wrote. ”A   temperamental,     and lip, uninformed commander in chief is too great a risk for America.” Robert Gates: I question Hillary Clinton’s judgment on email server, Gates called Trump too ”willfully ignorant about the rest of the world” to be commander in chief. He specifically criticized Trump’s plan to build a wall on the US border with Mexico, his call to torture terrorists and kill their family members, and his praise of Russian President Vladmir Putin. ”At least on national security, I believe Mr. Trump is beyond repair. He is stubbornly uninformed about the world and how to lead our country and government, and temperamentally unsuited to lead our men and women in uniform,” Gates wrote. ”He is unqualified and unfit to be commander in chief.” Despite his harsh criticism of Trump, Gates wrote that he remains an undecided voter. He criticized Clinton for advocating ”  regime change in Libya” and her shifting positions on the Iraq War and US trade agreements. ”Mrs. Clinton has ruled out putting U. S. ground troops in Iraq and Syria ’ever again,’” he wrote. ”That is a politically driven categorical declaration of a sort no president (or candidate) should make, and it raises the question whether she would pull out the 5, 000 U. S. troops now in Iraq. She has expressed no new ideas to deal with the boiling caldron that is today’s Middle East.” But, he wrote, Clinton can still earn his vote. ”Mrs. Clinton has time before the election to address forthrightly her trustworthiness, to reassure people about her judgment, to demonstrate her willingness to stake out one or more positions on national security at odds with her party’s conventional wisdom, and to speak beyond generalities about how she would deal with China, Russia, North Korea, Iran, the Middle East    and international trade,” he wrote. ”Whether and how she addresses these issues will, I believe, affect how many people vote    including me.” Republicans use Gates’ new book to hammer Clinton, Biden, Gates, who worked for eight presidents for more than 50 years, said the best commanders in chief hire advisers who aren’t afraid to contradict their boss. ”All of the presidents I served were strong personalities with strongly held views about the world,” he said. ”But each surrounded himself with   knowledgeable and experienced advisers who would tell the president what he needed to hear, not what he wanted to hear. ”Sometimes presidents would take their advice, sometimes not. But they always listened,” Gates wrote.