LONDON  —   Libyan fighters declared victory over the Islamic State at its coastal stronghold of Surt on Tuesday, ending the extremist group’s ambitions for a caliphate on the southern shores of the Mediterranean. “The battle is finally over,” said Reda Eissa, a spokesman for the coalition of militias from nearby Misurata that led the assault. “Our fighters are ecstatic. We still have to comb through the city and make sure we got them all, but we are so, so happy. ” The Libyan fighters’ apparent success was another defeat for the Islamic State, also known as ISIS or ISIL, as its plans for a militant empire buckle on multiple fronts across the Middle East. In Surt, the Misuratan militias finally ousted the remaining Islamic State fighters from a cluster of houses after a grueling   assault that pitted suicide bombers and snipers against Libyan forces backed by American warplanes. After moving into Surt in 2014, the Islamic State seized a   stretch of coastline and instituted a brutal reign that included public killings and the imprisonment of migrants as sex slaves. The city became a transit hub for fighters traveling to Tunisia, as well as a supply stop and medical treatment center for Islamists fighting in eastern Libya. The Misuratan brigades began their drive toward Islamic State positions in Surt in May. American warplanes joined the effort in August, carrying out at least 490 sorties over the city while    fighting raged in the streets below. Even as the Misuratan brigades celebrated on Tuesday, analysts warned that the Islamic State could still regroup in other parts of Libya by exploiting the economic ruin and political vacuum that has dogged the country since the ouster of Col. Muammar   in 2011. “I’m concerned about the pockets of marginalization, and in some areas   jihadist presence, that they could use to reconfigure,” said Frederic Wehrey, a senior fellow at the Carnegie Endowment for International Peace, citing the presence of Islamic State forces in Tripoli, Benghazi and the desert town of Sabha. Islamic State fighters could carry out bombings in an attempt to destabilize the fragile United   government in Tripoli, the capital, Mr. Wehrey said. But it is unlikely that the Islamic State will be able to capture such a significant town again, he added. During the battle for Surt, both sides faced accusations of human rights abuses. Many of the sex slaves held by the Islamic State in Surt were African migrants captured as they crossed the Libyan Desert in hopes of reaching the coast so they could make the perilous sea journey to Europe. At least 100 women and children who escaped Surt during the fighting, many from Eritrea, are being held at a prison in Misurata where they have given accounts of being abused and  . The Libyan fighters from Misurata have faced accusations of torture and summary killings. A video recently emerged showing Misuratan militiamen interrogating and threatening to kill an Islamic State fighter named Mletan. Photographs that later circulated online showed the mutilated body of what appeared to be the same man being dragged along a street. Hanan Salah, a Libya researcher at Human Rights Watch, said on Tuesday that she had received reports from Libya that some public hospitals in Misurata had refused to treat civilians fleeing Surt on suspicion that they were members of the Islamic State. “The authorities are required to provide medical care to all those fleeing the fighting and who are in need of it, without distinction,” Ms. Salah said. The fall of Surt coincides with a concerted drive against the Islamic State in the Iraqi city of Mosul and a rapidly shifting fight in Syria. On Tuesday, Iraqi forces started shelling part of western Mosul as they prepared to open a new front in a battle now in its eighth week. The Misurata militias now in control of Surt nominally fight under the banner of the United   government in Tripoli, led by Prime Minister Fayez Serraj  —   one of three rival administrations vying for control of Libya. The United States also supports the unity government. But the government is weak, having failed to extend its authority even over Tripoli since it started work in March. And many leaders of the Misurata militias are more concerned about Gen. Khalifa Hifter, a strongman who dominates Benghazi and the east of the country, than about the Islamic State. During a tour of the Surt battlefield in June, Misuratan commanders said they believed the Islamic State fighters were being controlled secretly by General Hifter as part of his wider ambition to seize control of Libya. There is little evidence to back that assertion  —   General Hifter is fighting against Islamic State militants, although opportunistic alliances are common on all sides of the conflict  —   but the heated talk illustrates the difficulty of bringing the country to a political settlement. Last week in Tripoli, the most violent clashes in two years erupted between competing factions, and one group blocked a major highway with shipping containers. Mr. Serraj’s administration was left to watch helplessly. The United Nations envoy to Libya, Martin Kobler, said he was “extremely alarmed” by the clashes, and Mark C. Toner, a State Department spokesman, said on Monday that the warring factions should rally behind the faltering unity government. Another uncertainty in Libya concerns the policy of the new administration of   Donald J. Trump in the United States. On the campaign trail, Mr. Trump vowed to defeat the Islamic State but said he was averse to becoming involved in foreign countries. Mr. Trump’s expressed willingness to work with Russia and Egypt could lead to an alignment of United States efforts with those two countries’ policies in Libya. Egypt is a strong supporter of General Hifter, but the Obama administration has kept its distance from the general, who once worked for the C. I. A.