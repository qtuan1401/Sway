When Shahram Amiri emerged from the shadows into the spotlight six years ago, he was a young Iranian scientist who suddenly appeared on YouTube from a safe house, telling a bizarre story of having been kidnapped by the Central Intelligence Agency. Then, in another video that quickly followed, his story changed: He had come to the United States voluntarily to study, but desperately missed his son back in Tehran. Soon, father and son were reunited in Iran, in a joyous scene broadcast by the Iranian government. Then Mr. Amiri disappeared, amid rumors that he had been imprisoned. Questions, of course, went unanswered: Was he a spy, recruited by the United States for his insider knowledge of the Iranian nuclear program? Or a double agent, sent by Tehran to spread disinformation, or to learn what the Americans knew? On Sunday the case took what appears to be its final turn. “Shahram Amiri was hanged for revealing the country’s top secrets to the enemy,” Gholam Hossein Mohseni Ejei, a spokesman for Iran’s Justice Ministry, told reporters in Tehran, according to international news services and the country’s state news agency. Those stories confirmed initial reports from Saturday that quoted his mother saying she had seen his body. The American, Israeli and European search to understand the scope of Iran’s nuclear program  —   an intelligence effort that continues to this day  —   has taken many bizarre turns that have already become the stuff of books and film. And the drama of Mr. Amiri’s apparent double defection came in a summer of espionage efforts against Iran gone wrong. The Stuxnet computer virus was then replicating itself around the world, which ultimately revealed the sophisticated   cyberattack on Iran’s nuclear facilities that many today see as a turning point in the use of digital attacks. But few stories were as confusing, and at moments   as Mr. Amiri’s. Among the side players was Hillary Clinton, the secretary of state, who said as Mr. Amiri was returning to Iran: “He’s free to go. He was free to come. Those decisions are his alone to make. ” Some of her emails, made public last year during the controversy over her private email server, show that her top foreign policy aide warned her that the story was about to break, but they give little insight into what happened behind the scenes. Weeks after Mr. Amiri returned to Iran, American intelligence officials described the events on conditions of anonymity to a small group of reporters. Their story was that Mr. Amiri had been a voluntary recruit, interviewed and then placed in the agency’s equivalent of a witness protection program. When he first told his C. I. A. handlers that he planned to return, they warned him, according to the intelligence agency’s account, that it would probably end with his head in a noose. Mr. Amiri was 32 years old in 2009 when he left a university post to go on what he declared was a pilgrimage to Mecca. He disappeared when he got to Medina, in Saudi Arabia. He had left his shaving kit in an empty hotel room, and the Iranians guessed that he was with the Americans  —   and they accused the United States of kidnapping. He was an unlikely spy, a bit bumbling and nervous. By all accounts, Mr. Amiri was not in the inner circle around Mohsen Fakhrizadeh, the scientist who had run the weapons side of the Iranian nuclear program. But Mr. Amiri had seen a lot he worked at the academic center of research for the Iranian program. It now appears he may have begun work as an American source while he was still in Iran. As a specialist in measuring nuclear radiation, he had been to a number of sensitive Iranian sites, all of great interest to intelligence officials. According to officials familiar with his debriefing, he was among the sources who told the Americans about the internal Iranian debate over whether the country needed a nuclear weapon or just a “threshold capability” to build one on short notice without violating the Nuclear Nonproliferation Treaty and inviting a military backlash. By 2009, the C. I. A. had apparently decided that the chances he would be detected were rising, and offered to get him out of the country. The agency promised him $5 million and a new identity. Mr. Amiri believed his estranged wife would never leave Iran, and he decided to go alone, without his son. After he was interviewed in Washington, he ended up near Tucson, under the agency’s national resettlement program, which provides cover and protection for cooperative foreign spies. But he immediately missed his young son, and began calling home. Iranian intelligence agencies pressured his family, and by one account threatened to harm his son. They told Mr. Amiri to make a videotape claiming he had been kidnapped. He did, using a webcam to declare that he had been kidnapped in Medina “in a joint operation by the terror and abduction units” of the C. I. A. and Saudi Arabia’s intelligence service. ” He said he had been drugged and tortured. Two months later, in 2010, the video showed up on Iranian state television. The C. I. A. made its own video with Mr. Amiri, filmed in the friendly setting of a study. In that one, Mr. Amiri contradicted what he had said in the first. “I am free here,” he said, “and I assure everyone that I am quite safe. ” His estranged wife told Iranian television that the second video must have been faked. “He was reading text,” she said. A few weeks later the Iranians broadcast a third video, in which Mr. Amiri returned to the story that he had been kidnapped, but had escaped his captors. Behind the scenes, Mr. Amiri was telling his handlers that he had made a mistake by defecting, and only wanted to return to see his son. He was warned of what had happened to Soviet defectors  —   prison and potentially execution  —   who had returned. The C. I. A. ’s resettlement program has clear rules that if a defector wants to return home, there is no legal basis for the United States to force him to stay. So in July 2010, Mr. Amiri ended up in a taxi to a side office of the Pakistani Embassy in Northwest Washington, near the vice president’s residence. (In the absence of diplomatic relations between Iran and the United States, Pakistan represents Iran’s interests.) He landed in Tehran on July 15, 2010, and his young son was there to embrace him. The heartwarming picture was broadcast throughout the country. Mr. Amiri told Iranian journalists that he had been offered millions of dollars to stay in the United States and reveal all he knew about the nuclear program, but had not done so. He told interviewers that he had never been in the two most sensitive Iranian nuclear sites, at Natanz and Fordo. Weeks later, he disappeared. His mother said on the BBC Persian service over the weekend that he had initially been sentenced to 10 years in prison, though Iranian officials had never announced that. Last month, she said, that punishment was changed to a death sentence. She said he had tried to console her, saying he would finally be free and at peace.