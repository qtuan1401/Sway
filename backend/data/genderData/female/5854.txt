VIENTIANE, Laos  —   President Obama has grown accustomed to having his foreign travels overshadowed by terrorist attacks or police shootings. This might be the first time one of his trips has been marred by bad manners. On his final visit to Asia as president this week, Mr. Obama had intended to confront America’s wartime legacy in Laos and to reaffirm his strategic pivot to the region. Like all presidential trips, it has been meticulously planned to showcase achievements: a   partnership with China and vigorous American engagement with China’s neighbors. But in four messy days, the president lost the clear message choreographed by his advance team. There was the chaotic arrival ceremony in China, in which missing aircraft stairs unexpectedly trumped the theme of global warming. And then, an ugly personal outburst that prompted Mr. Obama to cancel a meeting with the new leader of the Philippines, an ally the United States will need in the coming contest with China for regional influence. On Tuesday, the White House scrambled to limit the fallout from skipping a meeting with Rodrigo Duterte, the Philippines’ president. Mr. Obama pulled the plug after hearing that Mr. Duterte had unleashed a profane diatribe against him, threatening to repeat it to Mr. Obama’s face if he dared ask him about recent extrajudicial killings in his country. Mr. Obama is dealing with other headwinds, not least that he is a   leader in the last five months of his term. Back home, his struggles are viewed through the unforgiving lens of   politics. Donald J. Trump, the Republican nominee, tweeted that the Chinese snubbed Mr. Obama and that Mr. Duterte called him a “’u2009‘son of a whore.’ Terrible!” For a president eager to burnish his legacy, the trip has in fact yielded progress on several fronts, most notably climate change. But the miscues illustrate how poor planning, or even plain bad luck, can undermine a president’s performance abroad. Worse, the dispute with Mr. Duterte carries genuine risks for the United States, given the sensitive role of the Philippines as an American treaty ally that is engaged in an increasingly dangerous standoff with Beijing over maritime claims in the South China Sea. Scrapping the meeting, American officials insisted, was less an expression of Mr. Obama’s pique than a recognition that the news media would treat it as a spectacle. “All of the focus was on those comments,” said Benjamin J. Rhodes, the deputy national security adviser. “We felt that did not create a constructive environment for a bilateral meeting. ” Mr. Rhodes insisted that the alliance between the United States and the Philippines was “rock solid” the two countries work together on a range of issues, from drug interdiction to counterterrorism. He said it was possible that Mr. Obama might run into Mr. Duterte anyway, since the two are attending a meeting of the Association of Southeast Asian Nations here in Vientiane. Hillary Clinton said Mr. Obama’s decision to cancel the meeting was “exactly the right choice. ” She said the president was likely to raise concerns about extrajudicial killings of alleged drug dealers, “and when the president of the Philippines insulted our president, it was appropriate in a very   way to say, ‘Sorry, no meeting. ’’u2009” Mr. Duterte seemed eager to defuse the situation. In a statement, he said he regretted that his comments “came across as a personal attack on the U. S. president. ” He said he had overreacted to reports that said Mr. Obama planned to lecture him in their meeting about his unorthodox methods in combating the drug trade. “We look forward to ironing out differences arising out of national priorities and perceptions,” Mr. Duterte said, “and working in mutually responsible ways for both countries. ” For Mr. Obama, it was an unseemly distraction from what he hoped would be a somber day of remembrance and reconciliation. The first president to visit Laos, Mr. Obama came with a pledge to double American aid, to $30 million a year over three years, to help Laotians find unexploded bombs in their forests and fields. The United States dropped more than two million tons of explosives on this country during its secret war from 1964 to 1973, a legacy Mr. Obama said too few Americans understood. “As one Laotian said, the ‘bombs fell like rain,’’u2009” he said to a polite audience at the Lao National Cultural Hall. There was no evidence that Mr. Duterte’s tiff with Mr. Obama mattered much to Laotians. But it could matter more to   relations than Mr. Rhodes’s reassuring words suggest. Mr. Duterte appears determined to carve out a more independent foreign policy than his reliably   predecessor, Benigno S. Aquino III. He has talked about trying to settle an impasse with China over the Scarborough Shoal, a disputed clump of rocks in the South China Sea. The United States worries that China will use its influence to pressure its neighbors into agreements over disputed reefs and shoals throughout the South China Sea that could eventually hinder the freedom of navigation for American ships. Mr. Rhodes said the United States would give the Philippines leeway to negotiate an agreement with China, with the important caveat that it adhere to international law. That is a message Mr. Obama would likely have given Mr. Duterte in person. “We should prepare for a wild ride since the constantly changing outbursts of President Duterte undermine the stability of the government’s foreign policy, including U. S.  relations,” Ramon Casiple, head of the Institute for Political and Electoral Reform in Manila. The diatribe against Mr. Obama, he said, was “kneejerk as an outburst, but calculated to produce a certain breathing space for negotiations with China. ” Mr. Obama had his own awkwardness with the Chinese when he arrived at a Group of 20 summit meeting Saturday. A   dispute over who would drive the staircase to the doorway on Air Force One forced him to exit from a door in the plane’s belly. White House officials attributed the dispute to inexperienced, overzealous security officials rather than any premeditated effort to humiliate Mr. Obama. But the images of Chinese guards shouting at reporters and hassling the president’s national security adviser, Susan E. Rice, added to the sense that the Chinese were sticking a thumb in his eye. As with the Philippine affair, administration officials said the airport scene would have no spillover effect. Mr. Obama himself described the visit as “extraordinarily productive,” noting that he and President Xi Jinping had continued their landmark collaboration on climate change. “None of this detracts from the broader scope of the relationship,” he said. And yet, administration officials showed delight in the fact that when Mr. Obama left Hangzhou on Monday evening, the Chinese moved a shiny staircase with blue lighting to the side of Air Force One.